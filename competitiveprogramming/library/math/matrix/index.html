<!DOCTYPE html>
<html lang="en">
    <head>
          <meta http-equiv="content-type" content="text/html; charset=utf-8">
          <meta name="viewport" content="width=device-width, initial-scale=1.0">
          <meta name="description" content="">
          <meta name="generator" content="Hugo 0.56.3" />
          <title>Matrix | Spielsand</title>

          
          
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

          <!--[if lte IE 8]>
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
          <![endif]-->
          <!--[if gt IE 8]><!-->
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
          <!--<![endif]-->

          <!--[if lte IE 8]>
          <link rel="stylesheet" href="https://chiyosbigdragon.github.io/css/side-menu-old-ie.css">
          <![endif]-->
          <!--[if gt IE 8]><!-->
          <link rel="stylesheet" href="https://chiyosbigdragon.github.io/css/side-menu.css">
          <!--<![endif]-->

          <link rel="stylesheet" href="https://chiyosbigdragon.github.io/css/blackburn.css">

          
          <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

          
          <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

         
          

          
          <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github-gist.min.css">
          <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
          
          <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
          
          <script>hljs.initHighlightingOnLoad();</script>
          

          <link rel="shortcut icon" href="https://chiyosbigdragon.github.io/img/favicon.ico" type="image/x-icon" />

        
          <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

          <link rel="stylesheet" href="https://chiyosbigdragon.github.io/css/top.css">
          <link rel="stylesheet" href="https://chiyosbigdragon.github.io/css/my.css">
          <script src="https://chiyosbigdragon.github.io/js/srcReader.js"></script>

    </head>
<body>
    <div id="layout">

      
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://chiyosbigdragon.github.io/">Spielsand</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://chiyosbigdragon.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://chiyosbigdragon.github.io/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://chiyosbigdragon.github.io/blog/"><i class='fa fa-list fa-fw'></i>Blog</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://chiyosbigdragon.github.io/competitiveprogramming/"><i class='fa fa-bug fa-fw'></i>C-Programming</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/ChiyosBigDragon" rel="me" target="_blank"><i class="fab fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2019. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>



<div class="header">
    <h1>Matrix</h1>
    
</div>
<div class="content">

  

<h1 id="概略">概略</h1>

<p>行列計算</p>

<h1 id="目次">目次</h1>

<ul>
<li><a href="#アルゴリズム">アルゴリズム</a></li>
<li><a href="#実装例">実装例</a></li>
<li><a href="#verify">verify</a>

<ul>
<li><a href="#AOJ_ITP1_7_D">AOJ ITP1_7_D</a></li>
<li><a href="#ABC009_D">ABC009_D</a></li>
<li><a href="#yuki_194">yukicoder No.194</a></li>
</ul></li>
<li><a href="#参考">参考</a></li>
</ul>

<h1 id="アルゴリズム">アルゴリズム</h1>

<p>特になし</p>

<h1 id="実装例">実装例</h1>

<ul>
<li>Matrix$(h,w)$ := $h$ 行 $w$ 列の行列を作成し，$0$ で初期化．</li>
<li>Matrix$(G)$ := 行列を2次元配列 $G$ で初期化．</li>
<li>height$()$, width$()$ := 行列のサイズを取得．

<ul>
<li>$O(1)$</li>
</ul></li>
<li>I$(n,x)$ := 単位元を $x$ とする $n$ 次単位行列．

<ul>
<li>$O(n^2)$</li>
<li>零元も設定できるようにするべき？</li>
</ul></li>
<li>演算子オーバーロード

<ul>
<li>加法<code>+,+=</code>，差<code>-,-=</code> $O(n^2)$</li>
<li>乗法<code>*,*=</code> $O(n^3)$</li>
<li>添字アクセス<code>[]</code> $O(1)$</li>
</ul></li>
<li>pow$(k)$ := 行列累乗

<ul>
<li>$O(n^3\log k)$</li>
<li>別でpower作って任意のクラスを載せられるほうがよくないか．取ってくるの面倒だけど</li>
</ul></li>
<li>必要になったら作るやつ

<ul>
<li>線形代数の勉強から始めないといけない</li>
<li>スカラー倍</li>
<li>転置</li>
<li>行列式</li>
<li>ランク</li>
<li>トレース</li>
</ul></li>
</ul>

<div class="SyntaxHighlight">
	<div align="right" style="color: #3b8bba; margin:-10px 0px -10px 0px; cursor: pointer;">[展開する]</div>
	<pre><code class="language-cpp" src="https://raw.githubusercontent.com/ChiyosBigDragon/Library/master/Math/Matrix/Matrix.cpp"></code></pre>
</div>


<h1 id="verify">verify</h1>

<h4 id="AOJ_ITP1_7_D"><a href="https://onlinejudge.u-aizu.ac.jp/problems/ITP1_7_D">行列の積 - ITP1_7_D &mdash; AIZU ONLINE JUDGE</a></h4>

<div class="SyntaxHighlight">
	<div align="right" style="color: #3b8bba; margin:-10px 0px -10px 0px; cursor: pointer;">[展開する]</div>
	<pre><code class="language-cpp" src="https://raw.githubusercontent.com/ChiyosBigDragon/Library/master/Math/Matrix/verify/ITP1_7_D.cpp"></code></pre>
</div>


<h4 id="ABC009_D"><a href="https://atcoder.jp/contests/abc009/tasks/abc009_4">D - 漸化式 - AtCoder Beginner Contest 009 &mdash; AtCoder</a></h4>

<p>$$
\begin{aligned}
    \left(
        \begin{array}{ccc}
            A _ {N+K} \\ A _ {N+K-1} \\ A _ {N+K-2} \\ \vdots \\ A _ {N+1}
        \end{array}
    \right)
    =
    \left(
        \begin{array}{ccc}
            C _ 1 &amp; C _ 2 &amp; \ldots &amp; C _ {K-1} &amp; C _ K \\ 1 &amp; 0 &amp; \ldots &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; \ldots &amp; 0 &amp; 0 \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots \\ 0 &amp; 0 &amp; \ldots &amp; 1 &amp; 0
        \end{array}
    \right)
    \left(
        \begin{array}{ccc}
            A _ {N+K-1} \\ A _ {N+K-2} \\ A _ {N+K-3} \\ \vdots \\ A _ {N}
        \end{array}
    \right)
\end{aligned}
$$</p>

<p>$$
\therefore
\begin{aligned}
    \left(
        \begin{array}{ccc}
            A _ {N+K} \\ A _ {N+K-1} \\ A _ {N+K-2} \\ \vdots \\ A _ {N+1}
        \end{array}
    \right)
    =
    \left(
        \begin{array}{ccc}
            C _ 1 &amp; C _ 2 &amp; \ldots &amp; C _ {K-1} &amp; C _ K \\ 1 &amp; 0 &amp; \ldots &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp;  \ldots &amp; 0 &amp; 0 \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots \\ 0 &amp; 0 &amp; \ldots &amp; 1 &amp; 0
        \end{array}
    \right) ^ N
    \left(
        \begin{array}{ccc}
            A _ {K} \\ A _ {K-1} \\ A _ {K-2} \\ \vdots \\ A _ {1}
        \end{array}
    \right)
\end{aligned}
$$</p>

<p>AND演算の単位元が<code>UINT_MAX</code>であることに注意．</p>

<div class="SyntaxHighlight">
	<div align="right" style="color: #3b8bba; margin:-10px 0px -10px 0px; cursor: pointer;">[展開する]</div>
	<pre><code class="language-cpp" src="https://raw.githubusercontent.com/ChiyosBigDragon/Library/master/Math/Matrix/verify/ABC009_D.cpp"></code></pre>
</div>


<h4 id="yuki_194"><a href="https://yukicoder.me/problems/no/194">No.194 フィボナッチ数列の理解(1) &mdash; yukicoder</a></h4>

<p>$$
\begin{cases}
    F(k) = S(k-1) - S(k-n-1) \\ S(k) = F(k) + S(k-1)
\end{cases}
$$</p>

<p>$$
\therefore S(k) = 2S(k-1) - S(k-n-1)
$$</p>

<p>$$
\left(
    \begin{array}{ccc}
        S(k) \\ S(k-1) \\ \vdots \\ S(k-n)
    \end{array}
\right) =
\left(
    \begin{array}{ccc}
        2 &amp; 0 &amp; \ldots &amp; 0 &amp; -1 \\ 1 &amp; 0 &amp; \ldots &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; \ldots &amp; 0 &amp; 0 \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots \\ 0 &amp; 0 &amp; \ldots &amp; 1 &amp; 0
    \end{array}
\right)
\left(
    \begin{array}{ccc}
        S(k-1) \\ S(k-2) \\ \vdots \\ S(k-n-1)
    \end{array}
\right)
$$</p>

<p>$$
\therefore
\left(
    \begin{array}{ccc}
        S(k) \\ S(k-1) \\ \vdots \\ S(k-n)
    \end{array}
\right) =
\left(
    \begin{array}{ccc}
        2 &amp; 0 &amp; \ldots &amp; 0 &amp; -1 \\ 1 &amp; 0 &amp; \ldots &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; \ldots &amp; 0 &amp; 0 \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots \\ 0 &amp; 0 &amp; \ldots &amp; 1 &amp; 0
    \end{array}
\right) ^ {k-n}
\left(
    \begin{array}{ccc}
        S(n) \\ S(n-1) \\ \vdots \\ S(0)
    \end{array}
\right)
$$</p>

<p>要: <a href="../mod_int/">ModInt</a></p>

<div class="SyntaxHighlight">
	<div align="right" style="color: #3b8bba; margin:-10px 0px -10px 0px; cursor: pointer;">[展開する]</div>
	<pre><code class="language-cpp" src="https://raw.githubusercontent.com/ChiyosBigDragon/Library/master/Math/Matrix/verify/yuki194.cpp"></code></pre>
</div>


<h1 id="参考">参考</h1>

<ul>
<li><a href="https://ei1333.github.io/luzhiled/snippets/math/matrix.html">行列演算(Matrix) &mdash; Luzhiled&rsquo;s memo</a></li>
<li><a href="http://www.learning-algorithms.com/entry/2017/10/13/193130">行列ライブラリ &mdash; Learning Algorithms</a></li>
<li><a href="https://emtubasa.hateblo.jp/entry/2018/09/07/131441">ABC009 D - 漸化式 &mdash; ツバサの備忘録</a></li>
</ul>


</div>


    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.css" integrity="sha384-dbVIfZGuN1Yq7/1Ocstc1lUEm+AT+/rCkibIcC/OmWo5f0EA48Vf8CytHzGrSwbQ" crossorigin="anonymous">
    
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.js" integrity="sha384-2BKqo+exmr9su6dir+qCw08N2ZKRucY4PrGQPPWU1A7FtlCGjmEGFqXCv5nyM5Ij" crossorigin="anonymous"></script>
    
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        renderMathInElement(document.body, {
            delimiters: [
                { left: "$",   right: "$",   display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "$$",   right: "$$",   display: true },
                { left: "\\[", right: "\\]", display: true  },
            ],
        });
    });
    </script>



    <link href="https://fonts.googleapis.com/css?family=Noto+Serif+JP:400,600&amp;subset=japanese" rel="stylesheet">


    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-126147693-2"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-126147693-2');
    </script>

